<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PPFD Calculator</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background-color: #f7f9fc;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      overflow-y: auto;
    }

    #ppfd-calculator {
      width: 100%;
      max-width: 500px;
      background-color: #ffffff;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      padding: 20px;
      margin: 20px;
    }

    h2 {
      text-align: center;
      color: #333333;
      margin-bottom: 20px;
    }

    label, fieldset {
      font-size: 14px;
      color: #555555;
      margin-bottom: 10px;
      display: block;
    }

    select, input {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      margin-bottom: 15px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
      background-color: #f9f9f9;
      transition: all 0.3s ease;
    }

    input[type="checkbox"] {
      width: auto;
    }

    select:focus, input:focus {
      outline: none;
      border-color: #28a745;
      background-color: #ffffff;
    }

    fieldset {
      border: 1px solid #ddd;
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 6px;
    }

    legend {
      font-weight: bold;
      color: #555555;
    }

    button {
      background-color: #28a745;
      color: white;
      padding: 12px 20px;
      font-size: 16px;
      font-weight: bold;
      border: none;
      border-radius: 4px;
      width: 100%;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    button:hover {
      background-color: #218838;
    }

    #result-box {
      margin-top: 20px;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 6px;
      background-color: #e9f7ef;
      text-align: center;
    }

    #result {
      font-size: 20px;
      font-weight: bold;
      color: #155724;
    }

    @media (max-width: 600px) {
      #ppfd-calculator {
        padding: 15px;
      }

      button {
        font-size: 14px;
      }
    }
  </style>
</head>
<body>
  <div id="ppfd-calculator">
    <h2>High Powered Organics dynamic PPFD calculator</h2>
    <form id="calculator-form">
      <label>
        Grower Skill (Crop Years):
        <input type="number" id="growerSkill" min="0" max="10" value="5">
      </label>

      <label>
        Strain Type:
        <select id="strainType">
          <option value="Auto">Auto</option>
          <option value="Photoperiod" selected>Photoperiod</option>
        </select>
      </label>

      <label>
        Growth Phase:
        <select id="growthPhase" onchange="updatePhaseOptions()">
          <option value="Seedling/Early Veg">Seedling/Early Veg</option>
          <option value="Fast Vegetative Period">Fast Vegetative Period</option>
          <option value="Stretch Phase of Flower">Stretch Phase of Flower</option>
          <option value="Bulk Phase of Flower">Bulk Phase of Flower</option>
          <option value="Ripening Phase of Flower">Ripening Phase of Flower</option>
        </select>
      </label>

      <label>
        Soil Type:
        <select id="soilType">
          <option value="Full Spectrum">GRO-DIRT Full Spectrum</option>
          <option value="Lite">GRO-DIRT Lite</option>
          <option value="Super Starter">GRO-DIRT Super Starter</option>
        </select>
      </label>

      <label>
        Soil Buffer Size:
        <select id="soilBuffer">
          <option value="Small">Small</option>
          <option value="Adequate" selected>Adequate</option>
          <option value="Luxury">Luxury</option>
        </select>
      </label>

      <label>
        VPD:
        <input type="number" id="vpd" step="0.1" value="1.0">
      </label>

      <label>
        Stress Level:
        <select id="stressLevel">
          <option value="1">Low</option>
          <option value="2" selected>Moderate</option>
          <option value="3">High</option>
          <option value="4">Very High</option>
        </select>
      </label>

      <label>
        CO2 Enrichment:
        <input type="checkbox" id="co2"> Enable CO2
      </label>

      <label>
        Green-Supreme Dosage:
        <select id="greenSupreme">
          <option value="0">None</option>
          <option value="10">ALL-GOOD</option>
          <option value="25">MAD-GOOD</option>
          <option value="50">YOU-SO-EXTRA</option>
          <option value="75">VITAL-FORCE</option>
        </select>
      </label>

      <fieldset>
        <legend>Microbial Products:</legend>
        <label>
          RHIZO-MOJO:
          <select class="microbe" id="rhizo">
            <option value="0">None</option>
            <option value="5">Low Dose</option>
            <option value="10">High Dose</option>
          </select>
        </label>
        <label>
          DARK-MATTER:
          <select class="microbe" id="dark">
            <option value="0">None</option>
            <option value="5">Low Dose</option>
            <option value="10">High Dose</option>
          </select>
        </label>
        <label>
          ANTI-MATTER:
          <select class="microbe" id="anti">
            <option value="0">None</option>
            <option value="3.5">Low Dose</option>
            <option value="7">High Dose</option>
          </select>
        </label>
      </fieldset>

      <fieldset>
        <legend>Top Dressings:</legend>
        <label><input type="checkbox" class="top-dressing" id="supergrass" value="Supergrass"> HERB-SUPERB Supergrass</label><br>
        <label><input type="checkbox" class="top-dressing" id="balance" value="Balance"> HERB-SUPERB Balance</label><br>
        <label><input type="checkbox" class="top-dressing" id="mega-yield" value="Mega Yield"> HERB-SUPERB Mega Yield</label><br>
        <label><input type="checkbox" class="top-dressing" id="stone-age" value="Stone-Age"> STONE-AGE</label>
      </fieldset>

      <fieldset>
        <legend>Soluble Products:</legend>
        <label><input type="checkbox" class="soluble-product" id="grow" value="Grow"> AQUA-MARINE Grow</label><br>
        <label><input type="checkbox" class="soluble-product" id="bloom" value="Bloom"> AQUA-MARINE Bloom</label><br>
        <label><input type="checkbox" class="soluble-product" id="ocean-potion" value="Ocean Potion"> OCEAN-POTION</label>
      </fieldset>

      <button type="button" onclick="calculatePPFD()">Calculate PPFD</button>
      <button type="button" onclick="resetForm()">Clear Form</button>
    </form>

    <div id="result-box">
      <h3>Result:</h3>
      <p id="result">Your PPFD calculation will appear here.</p>
    </div>
  </div>

  <script>
    function updatePhaseOptions() {
      const phase = document.getElementById("growthPhase").value;

      const allowedTopDressings = {
        "Seedling/Early Veg": [],
        "Fast Vegetative Period": ["supergrass", "balance", "stone-age"],
        "Stretch Phase of Flower": ["balance", "stone-age"],
        "Bulk Phase of Flower": ["mega-yield", "stone-age"],
        "Ripening Phase of Flower": ["mega-yield", "stone-age"]
      };

      const allowedSolubles = {
        "Seedling/Early Veg": ["grow", "ocean-potion"],
        "Fast Vegetative Period": ["grow", "ocean-potion"],
        "Stretch Phase of Flower": ["bloom", "ocean-potion"],
        "Bulk Phase of Flower": ["bloom", "ocean-potion"],
        "Ripening Phase of Flower": ["bloom", "ocean-potion"]
      };

      const allowedSoilTypes = {
        "Seedling/Early Veg": ["Super Starter"],
        "Fast Vegetative Period": ["Full Spectrum", "Lite"],
        "Stretch Phase of Flower": ["Full Spectrum", "Lite"],
        "Bulk Phase of Flower": ["Full Spectrum", "Lite"],
        "Ripening Phase of Flower": ["Full Spectrum", "Lite"]
      };

      document.querySelectorAll(".top-dressing").forEach(input => {
        input.disabled = !allowedTopDressings[phase].includes(input.id);
      });

      document.querySelectorAll(".soluble-product").forEach(input => {
        input.disabled = !allowedSolubles[phase].includes(input.id);
      });

      document.querySelectorAll("#soilType option").forEach(option => {
        option.disabled = !allowedSoilTypes[phase].includes(option.value);
      });
    }

    function calculatePPFD() {
      const growthPhase = document.getElementById("growthPhase").value;

      const basePPFD = {
        "Seedling/Early Veg": 250,
        "Fast Vegetative Period": 400,
        "Stretch Phase of Flower": 500,
        "Bulk Phase of Flower": 700,
        "Ripening Phase of Flower": 600
      }[growthPhase];

      let ppfd = basePPFD;

      const growerSkill = parseInt(document.getElementById("growerSkill").value, 10);
      const strainType = document.getElementById("strainType").value;
      const soilType = document.getElementById("soilType").value;
      const soilBuffer = document.getElementById("soilBuffer").value;
      const vpd = parseFloat(document.getElementById("vpd").value);
      const co2 = document.getElementById("co2").checked;

      const soilModifiers = {
        "Super Starter": 25,
        "Lite": 50,
        "Full Spectrum": 75
      };

      const bufferModifiers = {
        "Small": -50,
        "Adequate": 0,
        "Luxury": 50
      };

      ppfd += growerSkill * 10; 
      ppfd += strainType === "Photoperiod" ? 50 : -50;
      ppfd += soilModifiers[soilType] || 0;
      ppfd += bufferModifiers[soilBuffer] || 0;

      if (vpd < 0.8 || vpd > 1.5) ppfd -= 50;
      if (co2) ppfd += 150;

      const greenSupreme = parseInt(document.getElementById("greenSupreme").value, 10);
      const greenSupremeImpact = { 0: 0, 10: 12.5, 25: 25, 50: 37.5, 75: 50 };

      const stressReduction =
        greenSupremeImpact[greenSupreme] +
        (document.querySelector("#ocean-potion").checked ? 10 : 0) +
        parseFloat(document.getElementById("rhizo").value) +
        parseFloat(document.getElementById("dark").value) +
        parseFloat(document.getElementById("anti").value);

      const totalStressReduction = Math.min(stressReduction, 90);
      const stressLevel = parseInt(document.getElementById("stressLevel").value, 10);
      const stressPenalty = Math.max(1, stressLevel * (1 - totalStressReduction / 100)) * 25;

      const selectedTopDressings = Array.from(document.querySelectorAll(".top-dressing:checked")).length * 25;
      const selectedSolubles = Array.from(document.querySelectorAll(".soluble-product:checked")).length * 25;
      const microbialBoost =
        parseFloat(document.getElementById("rhizo").value) +
        parseFloat(document.getElementById("dark").value) +
        parseFloat(document.getElementById("anti").value);

      const biostimulantBoost = selectedTopDressings + selectedSolubles + microbialBoost * 10;

      ppfd -= stressPenalty;
      ppfd += biostimulantBoost;

      const optimalPPFD = {
        "Seedling/Early Veg": [250, 400],
        "Fast Vegetative Period": [400, 700],
        "Stretch Phase of Flower": [500, 850],
        "Bulk Phase of Flower": [700, 1000],
        "Ripening Phase of Flower": [600, 900]
      }[growthPhase];

      ppfd = Math.max(optimalPPFD[0], Math.min(ppfd, optimalPPFD[1]));

      document.getElementById("result").innerText = `Recommended PPFD: ${Math.round(ppfd)} µmol/m²/s`;
    }

    function resetForm() {
      document.getElementById("calculator-form").reset();
      updatePhaseOptions();
      document.getElementById("result").innerText = "Your PPFD calculation will appear here.";
    }

    updatePhaseOptions();
  </script>
</body>
</html>
